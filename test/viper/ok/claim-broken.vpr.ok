<<<<<<< HEAD
field $message_async: Int
method __init__($Self: Ref)   
=======
method __init__($Self: Ref) 
  requires ((true && acc(($Self).claimed,write)) && acc(($Self).count,write))
  ensures ((true && acc(($Self).claimed,write)) && acc(($Self).count,write))
>>>>>>> origin/viper
   { 
     ($Self).claimed := false
     ($Self).count := 0
     ($Self).$message_async := 0 
   }
field claimed: Bool
field count: Int
method claim($Self: Ref) 
  requires ((true && acc(($Self).claimed,write)) && acc(($Self).count,write))
  ensures ((true && acc(($Self).claimed,write)) && acc(($Self).count,write))
   { 
     if (!($Self).claimed)
        { 
          ($Self).$message_async := (($Self).$message_async + 1)
          exhale true
          inhale true
          ($Self).$message_async := (($Self).$message_async - 1)
          { 
             ($Self).claimed := true
             ($Self).count := 1 
           } 
        } 
   }
