<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>syntax.ml &mdash; Coverage report</title>
    <meta name="description" content="60.22% coverage in mo_def/syntax.ml">
    <link rel="stylesheet" href="../coverage.css"/>
    <script src="../highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body>
    <div id="header">
      <h1>
        <a href="../index.html">
          <span class="dirname">mo_def/</span>syntax.ml
        </a>
      </h1>
      <h2>60.22%</h2>
    </div>
    <div id="navbar">
      <span class="unvisited" style="top:30.64%"></span>
      <span class="unvisited" style="top:30.88%"></span>
      <span class="unvisited" style="top:31.12%"></span>
      <span class="unvisited" style="top:31.59%"></span>
      <span class="unvisited" style="top:31.83%"></span>
      <span class="unvisited" style="top:32.07%"></span>
      <span class="unvisited" style="bottom:24.47%"></span>
      <span class="unvisited" style="bottom:24.23%"></span>
      <span class="unvisited" style="bottom:23.99%"></span>
      <span class="unvisited" style="bottom:23.75%"></span>
      <span class="unvisited" style="bottom:23.52%"></span>
      <span class="unvisited" style="bottom:23.28%"></span>
      <span class="unvisited" style="bottom:23.04%"></span>
      <span class="unvisited" style="bottom:22.80%"></span>
      <span class="unvisited" style="bottom:22.57%"></span>
      <span class="unvisited" style="bottom:22.33%"></span>
      <span class="unvisited" style="bottom:22.09%"></span>
      <span class="unvisited" style="bottom:21.85%"></span>
      <span class="unvisited" style="bottom:21.62%"></span>
      <span class="unvisited" style="bottom:21.38%"></span>
      <span class="unvisited" style="bottom:21.14%"></span>
      <span class="unvisited" style="bottom:20.90%"></span>
      <span class="unvisited" style="bottom:20.67%"></span>
      <span class="unvisited" style="bottom:19.48%"></span>
      <span class="unvisited" style="bottom:19.24%"></span>
      <span class="unvisited" style="bottom:19.00%"></span>
      <span class="unvisited" style="bottom:18.76%"></span>
      <span class="unvisited" style="bottom:18.53%"></span>
      <span class="unvisited" style="bottom:12.59%"></span>
      <span class="unvisited" style="bottom:12.35%"></span>
      <span class="unvisited" style="bottom:12.11%"></span>
      <span class="unvisited" style="bottom:11.40%"></span>
      <span class="unvisited" style="bottom:11.16%"></span>
      <span class="unvisited" style="bottom:10.93%"></span>
      <span class="unvisited" style="bottom:3.09%"></span>
    </div>
    <div id="report">
      <div id="lines-layer">
        <pre>
<a id="L1"></a><span > </span>
<a id="L2"></a><span > </span>
<a id="L3"></a><span > </span>
<a id="L4"></a><span > </span>
<a id="L5"></a><span > </span>
<a id="L6"></a><span > </span>
<a id="L7"></a><span > </span>
<a id="L8"></a><span > </span>
<a id="L9"></a><span > </span>
<a id="L10"></a><span > </span>
<a id="L11"></a><span > </span>
<a id="L12"></a><span > </span>
<a id="L13"></a><span > </span>
<a id="L14"></a><span > </span>
<a id="L15"></a><span > </span>
<a id="L16"></a><span > </span>
<a id="L17"></a><span > </span>
<a id="L18"></a><span > </span>
<a id="L19"></a><span > </span>
<a id="L20"></a><span > </span>
<a id="L21"></a><span > </span>
<a id="L22"></a><span > </span>
<a id="L23"></a><span > </span>
<a id="L24"></a><span > </span>
<a id="L25"></a><span > </span>
<a id="L26"></a><span > </span>
<a id="L27"></a><span > </span>
<a id="L28"></a><span > </span>
<a id="L29"></a><span > </span>
<a id="L30"></a><span > </span>
<a id="L31"></a><span > </span>
<a id="L32"></a><span > </span>
<a id="L33"></a><span > </span>
<a id="L34"></a><span > </span>
<a id="L35"></a><span > </span>
<a id="L36"></a><span > </span>
<a id="L37"></a><span > </span>
<a id="L38"></a><span > </span>
<a id="L39"></a><span > </span>
<a id="L40"></a><span > </span>
<a id="L41"></a><span > </span>
<a id="L42"></a><span > </span>
<a id="L43"></a><span > </span>
<a id="L44"></a><span > </span>
<a id="L45"></a><span > </span>
<a id="L46"></a><span > </span>
<a id="L47"></a><span > </span>
<a id="L48"></a><span > </span>
<a id="L49"></a><span > </span>
<a id="L50"></a><span > </span>
<a id="L51"></a><span > </span>
<a id="L52"></a><span > </span>
<a id="L53"></a><span > </span>
<a id="L54"></a><span > </span>
<a id="L55"></a><span > </span>
<a id="L56"></a><span > </span>
<a id="L57"></a><span > </span>
<a id="L58"></a><span > </span>
<a id="L59"></a><span > </span>
<a id="L60"></a><span > </span>
<a id="L61"></a><span > </span>
<a id="L62"></a><span > </span>
<a id="L63"></a><span > </span>
<a id="L64"></a><span > </span>
<a id="L65"></a><span > </span>
<a id="L66"></a><span > </span>
<a id="L67"></a><span > </span>
<a id="L68"></a><span > </span>
<a id="L69"></a><span > </span>
<a id="L70"></a><span > </span>
<a id="L71"></a><span > </span>
<a id="L72"></a><span > </span>
<a id="L73"></a><span > </span>
<a id="L74"></a><span > </span>
<a id="L75"></a><span > </span>
<a id="L76"></a><span > </span>
<a id="L77"></a><span > </span>
<a id="L78"></a><span > </span>
<a id="L79"></a><span > </span>
<a id="L80"></a><span > </span>
<a id="L81"></a><span > </span>
<a id="L82"></a><span > </span>
<a id="L83"></a><span > </span>
<a id="L84"></a><span > </span>
<a id="L85"></a><span > </span>
<a id="L86"></a><span > </span>
<a id="L87"></a><span > </span>
<a id="L88"></a><span > </span>
<a id="L89"></a><span > </span>
<a id="L90"></a><span > </span>
<a id="L91"></a><span > </span>
<a id="L92"></a><span > </span>
<a id="L93"></a><span > </span>
<a id="L94"></a><span > </span>
<a id="L95"></a><span > </span>
<a id="L96"></a><span > </span>
<a id="L97"></a><span > </span>
<a id="L98"></a><span > </span>
<a id="L99"></a><span > </span>
<a id="L100"></a><span > </span>
<a id="L101"></a><span > </span>
<a id="L102"></a><span > </span>
<a id="L103"></a><span > </span>
<a id="L104"></a><span > </span>
<a id="L105"></a><span > </span>
<a id="L106"></a><span > </span>
<a id="L107"></a><span > </span>
<a id="L108"></a><span > </span>
<a id="L109"></a><span > </span>
<a id="L110"></a><span > </span>
<a id="L111"></a><span > </span>
<a id="L112"></a><span > </span>
<a id="L113"></a><span > </span>
<a id="L114"></a><span > </span>
<a id="L115"></a><span > </span>
<a id="L116"></a><span > </span>
<a id="L117"></a><span > </span>
<a id="L118"></a><span > </span>
<a id="L119"></a><span > </span>
<a id="L120"></a><span > </span>
<a id="L121"></a><span > </span>
<a id="L122"></a><span > </span>
<a id="L123"></a><span > </span>
<a id="L124"></a><span > </span>
<a id="L125"></a><span > </span>
<a id="L126"></a><span > </span>
<a id="L127"></a><span > </span>
<a id="L128"></a><span > </span>
<a id="L129"></a><span class="unvisited"> </span>
<a id="L130"></a><span class="unvisited"> </span>
<a id="L131"></a><span class="unvisited"> </span>
<a id="L132"></a><span > </span>
<a id="L133"></a><span class="unvisited"> </span>
<a id="L134"></a><span class="unvisited"> </span>
<a id="L135"></a><span class="unvisited"> </span>
<a id="L136"></a><span > </span>
<a id="L137"></a><span > </span>
<a id="L138"></a><span > </span>
<a id="L139"></a><span > </span>
<a id="L140"></a><span > </span>
<a id="L141"></a><span > </span>
<a id="L142"></a><span > </span>
<a id="L143"></a><span > </span>
<a id="L144"></a><span > </span>
<a id="L145"></a><span class="visited"> </span>
<a id="L146"></a><span class="visited"> </span>
<a id="L147"></a><span > </span>
<a id="L148"></a><span > </span>
<a id="L149"></a><span > </span>
<a id="L150"></a><span > </span>
<a id="L151"></a><span > </span>
<a id="L152"></a><span > </span>
<a id="L153"></a><span > </span>
<a id="L154"></a><span > </span>
<a id="L155"></a><span > </span>
<a id="L156"></a><span > </span>
<a id="L157"></a><span > </span>
<a id="L158"></a><span > </span>
<a id="L159"></a><span > </span>
<a id="L160"></a><span > </span>
<a id="L161"></a><span > </span>
<a id="L162"></a><span > </span>
<a id="L163"></a><span > </span>
<a id="L164"></a><span > </span>
<a id="L165"></a><span > </span>
<a id="L166"></a><span > </span>
<a id="L167"></a><span > </span>
<a id="L168"></a><span class="visited"> </span>
<a id="L169"></a><span > </span>
<a id="L170"></a><span > </span>
<a id="L171"></a><span > </span>
<a id="L172"></a><span > </span>
<a id="L173"></a><span > </span>
<a id="L174"></a><span > </span>
<a id="L175"></a><span > </span>
<a id="L176"></a><span class="visited"> </span>
<a id="L177"></a><span class="visited"> </span>
<a id="L178"></a><span class="visited"> </span>
<a id="L179"></a><span class="visited"> </span>
<a id="L180"></a><span > </span>
<a id="L181"></a><span > </span>
<a id="L182"></a><span > </span>
<a id="L183"></a><span > </span>
<a id="L184"></a><span > </span>
<a id="L185"></a><span > </span>
<a id="L186"></a><span > </span>
<a id="L187"></a><span > </span>
<a id="L188"></a><span > </span>
<a id="L189"></a><span > </span>
<a id="L190"></a><span > </span>
<a id="L191"></a><span > </span>
<a id="L192"></a><span > </span>
<a id="L193"></a><span > </span>
<a id="L194"></a><span > </span>
<a id="L195"></a><span > </span>
<a id="L196"></a><span > </span>
<a id="L197"></a><span > </span>
<a id="L198"></a><span > </span>
<a id="L199"></a><span > </span>
<a id="L200"></a><span > </span>
<a id="L201"></a><span > </span>
<a id="L202"></a><span > </span>
<a id="L203"></a><span > </span>
<a id="L204"></a><span > </span>
<a id="L205"></a><span > </span>
<a id="L206"></a><span > </span>
<a id="L207"></a><span > </span>
<a id="L208"></a><span > </span>
<a id="L209"></a><span > </span>
<a id="L210"></a><span > </span>
<a id="L211"></a><span > </span>
<a id="L212"></a><span > </span>
<a id="L213"></a><span > </span>
<a id="L214"></a><span > </span>
<a id="L215"></a><span > </span>
<a id="L216"></a><span > </span>
<a id="L217"></a><span > </span>
<a id="L218"></a><span > </span>
<a id="L219"></a><span > </span>
<a id="L220"></a><span > </span>
<a id="L221"></a><span > </span>
<a id="L222"></a><span > </span>
<a id="L223"></a><span > </span>
<a id="L224"></a><span > </span>
<a id="L225"></a><span > </span>
<a id="L226"></a><span > </span>
<a id="L227"></a><span > </span>
<a id="L228"></a><span > </span>
<a id="L229"></a><span > </span>
<a id="L230"></a><span > </span>
<a id="L231"></a><span > </span>
<a id="L232"></a><span > </span>
<a id="L233"></a><span > </span>
<a id="L234"></a><span > </span>
<a id="L235"></a><span > </span>
<a id="L236"></a><span > </span>
<a id="L237"></a><span > </span>
<a id="L238"></a><span > </span>
<a id="L239"></a><span > </span>
<a id="L240"></a><span > </span>
<a id="L241"></a><span > </span>
<a id="L242"></a><span > </span>
<a id="L243"></a><span > </span>
<a id="L244"></a><span > </span>
<a id="L245"></a><span > </span>
<a id="L246"></a><span > </span>
<a id="L247"></a><span > </span>
<a id="L248"></a><span > </span>
<a id="L249"></a><span > </span>
<a id="L250"></a><span > </span>
<a id="L251"></a><span > </span>
<a id="L252"></a><span > </span>
<a id="L253"></a><span > </span>
<a id="L254"></a><span > </span>
<a id="L255"></a><span > </span>
<a id="L256"></a><span > </span>
<a id="L257"></a><span > </span>
<a id="L258"></a><span > </span>
<a id="L259"></a><span > </span>
<a id="L260"></a><span > </span>
<a id="L261"></a><span > </span>
<a id="L262"></a><span > </span>
<a id="L263"></a><span > </span>
<a id="L264"></a><span > </span>
<a id="L265"></a><span > </span>
<a id="L266"></a><span > </span>
<a id="L267"></a><span > </span>
<a id="L268"></a><span > </span>
<a id="L269"></a><span > </span>
<a id="L270"></a><span > </span>
<a id="L271"></a><span > </span>
<a id="L272"></a><span > </span>
<a id="L273"></a><span > </span>
<a id="L274"></a><span > </span>
<a id="L275"></a><span > </span>
<a id="L276"></a><span > </span>
<a id="L277"></a><span > </span>
<a id="L278"></a><span > </span>
<a id="L279"></a><span > </span>
<a id="L280"></a><span > </span>
<a id="L281"></a><span > </span>
<a id="L282"></a><span > </span>
<a id="L283"></a><span > </span>
<a id="L284"></a><span > </span>
<a id="L285"></a><span > </span>
<a id="L286"></a><span > </span>
<a id="L287"></a><span > </span>
<a id="L288"></a><span > </span>
<a id="L289"></a><span > </span>
<a id="L290"></a><span > </span>
<a id="L291"></a><span > </span>
<a id="L292"></a><span > </span>
<a id="L293"></a><span > </span>
<a id="L294"></a><span > </span>
<a id="L295"></a><span > </span>
<a id="L296"></a><span > </span>
<a id="L297"></a><span > </span>
<a id="L298"></a><span > </span>
<a id="L299"></a><span > </span>
<a id="L300"></a><span > </span>
<a id="L301"></a><span > </span>
<a id="L302"></a><span > </span>
<a id="L303"></a><span > </span>
<a id="L304"></a><span > </span>
<a id="L305"></a><span > </span>
<a id="L306"></a><span > </span>
<a id="L307"></a><span > </span>
<a id="L308"></a><span > </span>
<a id="L309"></a><span > </span>
<a id="L310"></a><span > </span>
<a id="L311"></a><span class="visited"> </span>
<a id="L312"></a><span class="visited"> </span>
<a id="L313"></a><span class="visited"> </span>
<a id="L314"></a><span class="visited"> </span>
<a id="L315"></a><span > </span>
<a id="L316"></a><span > </span>
<a id="L317"></a><span > </span>
<a id="L318"></a><span class="unvisited"> </span>
<a id="L319"></a><span class="unvisited"> </span>
<a id="L320"></a><span class="unvisited"> </span>
<a id="L321"></a><span class="unvisited"> </span>
<a id="L322"></a><span class="unvisited"> </span>
<a id="L323"></a><span class="unvisited"> </span>
<a id="L324"></a><span class="unvisited"> </span>
<a id="L325"></a><span class="unvisited"> </span>
<a id="L326"></a><span class="unvisited"> </span>
<a id="L327"></a><span class="unvisited"> </span>
<a id="L328"></a><span class="unvisited"> </span>
<a id="L329"></a><span class="unvisited"> </span>
<a id="L330"></a><span class="unvisited"> </span>
<a id="L331"></a><span class="unvisited"> </span>
<a id="L332"></a><span class="unvisited"> </span>
<a id="L333"></a><span class="unvisited"> </span>
<a id="L334"></a><span class="unvisited"> </span>
<a id="L335"></a><span > </span>
<a id="L336"></a><span > </span>
<a id="L337"></a><span > </span>
<a id="L338"></a><span > </span>
<a id="L339"></a><span class="unvisited"> </span>
<a id="L340"></a><span class="unvisited"> </span>
<a id="L341"></a><span class="unvisited"> </span>
<a id="L342"></a><span class="unvisited"> </span>
<a id="L343"></a><span class="unvisited"> </span>
<a id="L344"></a><span > </span>
<a id="L345"></a><span > </span>
<a id="L346"></a><span > </span>
<a id="L347"></a><span > </span>
<a id="L348"></a><span > </span>
<a id="L349"></a><span > </span>
<a id="L350"></a><span > </span>
<a id="L351"></a><span > </span>
<a id="L352"></a><span > </span>
<a id="L353"></a><span class="visited"> </span>
<a id="L354"></a><span class="visited"> </span>
<a id="L355"></a><span > </span>
<a id="L356"></a><span > </span>
<a id="L357"></a><span class="visited"> </span>
<a id="L358"></a><span > </span>
<a id="L359"></a><span > </span>
<a id="L360"></a><span class="visited"> </span>
<a id="L361"></a><span > </span>
<a id="L362"></a><span > </span>
<a id="L363"></a><span class="visited"> </span>
<a id="L364"></a><span > </span>
<a id="L365"></a><span > </span>
<a id="L366"></a><span > </span>
<a id="L367"></a><span > </span>
<a id="L368"></a><span class="unvisited"> </span>
<a id="L369"></a><span class="unvisited"> </span>
<a id="L370"></a><span class="unvisited"> </span>
<a id="L371"></a><span > </span>
<a id="L372"></a><span > </span>
<a id="L373"></a><span class="unvisited"> </span>
<a id="L374"></a><span class="unvisited"> </span>
<a id="L375"></a><span class="unvisited"> </span>
<a id="L376"></a><span > </span>
<a id="L377"></a><span > </span>
<a id="L378"></a><span class="visited"> </span>
<a id="L379"></a><span > </span>
<a id="L380"></a><span > </span>
<a id="L381"></a><span > </span>
<a id="L382"></a><span > </span>
<a id="L383"></a><span > </span>
<a id="L384"></a><span class="visited"> </span>
<a id="L385"></a><span > </span>
<a id="L386"></a><span > </span>
<a id="L387"></a><span class="visited"> </span>
<a id="L388"></a><span class="visited"> </span>
<a id="L389"></a><span class="visited"> </span>
<a id="L390"></a><span > </span>
<a id="L391"></a><span > </span>
<a id="L392"></a><span class="visited"> </span>
<a id="L393"></a><span class="visited"> </span>
<a id="L394"></a><span class="visited"> </span>
<a id="L395"></a><span > </span>
<a id="L396"></a><span > </span>
<a id="L397"></a><span class="visited"> </span>
<a id="L398"></a><span class="visited"> </span>
<a id="L399"></a><span > </span>
<a id="L400"></a><span > </span>
<a id="L401"></a><span > </span>
<a id="L402"></a><span class="visited"> </span>
<a id="L403"></a><span > </span>
<a id="L404"></a><span > </span>
<a id="L405"></a><span class="visited"> </span>
<a id="L406"></a><span > </span>
<a id="L407"></a><span class="visited"> </span>
<a id="L408"></a><span class="unvisited"> </span>
<a id="L409"></a><span > </span>
<a id="L410"></a><span class="visited"> </span>
<a id="L411"></a><span class="visited"> </span>
<a id="L412"></a><span class="visited"> </span>
<a id="L413"></a><span > </span>
<a id="L414"></a><span > </span>
<a id="L415"></a><span class="visited"> </span>
<a id="L416"></a><span class="visited"> </span>
<a id="L417"></a><span class="visited"> </span>
<a id="L418"></a><span class="visited"> </span>
<a id="L419"></a><span class="visited"> </span>
<a id="L420"></a><span class="visited"> </span>
<a id="L421"></a><span > </span>
</pre>
      </div>
      <div id="text-layer">
        <pre id="line-numbers">
<a href="#L1">  1</a>
<a href="#L2">  2</a>
<a href="#L3">  3</a>
<a href="#L4">  4</a>
<a href="#L5">  5</a>
<a href="#L6">  6</a>
<a href="#L7">  7</a>
<a href="#L8">  8</a>
<a href="#L9">  9</a>
<a href="#L10"> 10</a>
<a href="#L11"> 11</a>
<a href="#L12"> 12</a>
<a href="#L13"> 13</a>
<a href="#L14"> 14</a>
<a href="#L15"> 15</a>
<a href="#L16"> 16</a>
<a href="#L17"> 17</a>
<a href="#L18"> 18</a>
<a href="#L19"> 19</a>
<a href="#L20"> 20</a>
<a href="#L21"> 21</a>
<a href="#L22"> 22</a>
<a href="#L23"> 23</a>
<a href="#L24"> 24</a>
<a href="#L25"> 25</a>
<a href="#L26"> 26</a>
<a href="#L27"> 27</a>
<a href="#L28"> 28</a>
<a href="#L29"> 29</a>
<a href="#L30"> 30</a>
<a href="#L31"> 31</a>
<a href="#L32"> 32</a>
<a href="#L33"> 33</a>
<a href="#L34"> 34</a>
<a href="#L35"> 35</a>
<a href="#L36"> 36</a>
<a href="#L37"> 37</a>
<a href="#L38"> 38</a>
<a href="#L39"> 39</a>
<a href="#L40"> 40</a>
<a href="#L41"> 41</a>
<a href="#L42"> 42</a>
<a href="#L43"> 43</a>
<a href="#L44"> 44</a>
<a href="#L45"> 45</a>
<a href="#L46"> 46</a>
<a href="#L47"> 47</a>
<a href="#L48"> 48</a>
<a href="#L49"> 49</a>
<a href="#L50"> 50</a>
<a href="#L51"> 51</a>
<a href="#L52"> 52</a>
<a href="#L53"> 53</a>
<a href="#L54"> 54</a>
<a href="#L55"> 55</a>
<a href="#L56"> 56</a>
<a href="#L57"> 57</a>
<a href="#L58"> 58</a>
<a href="#L59"> 59</a>
<a href="#L60"> 60</a>
<a href="#L61"> 61</a>
<a href="#L62"> 62</a>
<a href="#L63"> 63</a>
<a href="#L64"> 64</a>
<a href="#L65"> 65</a>
<a href="#L66"> 66</a>
<a href="#L67"> 67</a>
<a href="#L68"> 68</a>
<a href="#L69"> 69</a>
<a href="#L70"> 70</a>
<a href="#L71"> 71</a>
<a href="#L72"> 72</a>
<a href="#L73"> 73</a>
<a href="#L74"> 74</a>
<a href="#L75"> 75</a>
<a href="#L76"> 76</a>
<a href="#L77"> 77</a>
<a href="#L78"> 78</a>
<a href="#L79"> 79</a>
<a href="#L80"> 80</a>
<a href="#L81"> 81</a>
<a href="#L82"> 82</a>
<a href="#L83"> 83</a>
<a href="#L84"> 84</a>
<a href="#L85"> 85</a>
<a href="#L86"> 86</a>
<a href="#L87"> 87</a>
<a href="#L88"> 88</a>
<a href="#L89"> 89</a>
<a href="#L90"> 90</a>
<a href="#L91"> 91</a>
<a href="#L92"> 92</a>
<a href="#L93"> 93</a>
<a href="#L94"> 94</a>
<a href="#L95"> 95</a>
<a href="#L96"> 96</a>
<a href="#L97"> 97</a>
<a href="#L98"> 98</a>
<a href="#L99"> 99</a>
<a href="#L100">100</a>
<a href="#L101">101</a>
<a href="#L102">102</a>
<a href="#L103">103</a>
<a href="#L104">104</a>
<a href="#L105">105</a>
<a href="#L106">106</a>
<a href="#L107">107</a>
<a href="#L108">108</a>
<a href="#L109">109</a>
<a href="#L110">110</a>
<a href="#L111">111</a>
<a href="#L112">112</a>
<a href="#L113">113</a>
<a href="#L114">114</a>
<a href="#L115">115</a>
<a href="#L116">116</a>
<a href="#L117">117</a>
<a href="#L118">118</a>
<a href="#L119">119</a>
<a href="#L120">120</a>
<a href="#L121">121</a>
<a href="#L122">122</a>
<a href="#L123">123</a>
<a href="#L124">124</a>
<a href="#L125">125</a>
<a href="#L126">126</a>
<a href="#L127">127</a>
<a href="#L128">128</a>
<a href="#L129">129</a>
<a href="#L130">130</a>
<a href="#L131">131</a>
<a href="#L132">132</a>
<a href="#L133">133</a>
<a href="#L134">134</a>
<a href="#L135">135</a>
<a href="#L136">136</a>
<a href="#L137">137</a>
<a href="#L138">138</a>
<a href="#L139">139</a>
<a href="#L140">140</a>
<a href="#L141">141</a>
<a href="#L142">142</a>
<a href="#L143">143</a>
<a href="#L144">144</a>
<a href="#L145">145</a>
<a href="#L146">146</a>
<a href="#L147">147</a>
<a href="#L148">148</a>
<a href="#L149">149</a>
<a href="#L150">150</a>
<a href="#L151">151</a>
<a href="#L152">152</a>
<a href="#L153">153</a>
<a href="#L154">154</a>
<a href="#L155">155</a>
<a href="#L156">156</a>
<a href="#L157">157</a>
<a href="#L158">158</a>
<a href="#L159">159</a>
<a href="#L160">160</a>
<a href="#L161">161</a>
<a href="#L162">162</a>
<a href="#L163">163</a>
<a href="#L164">164</a>
<a href="#L165">165</a>
<a href="#L166">166</a>
<a href="#L167">167</a>
<a href="#L168">168</a>
<a href="#L169">169</a>
<a href="#L170">170</a>
<a href="#L171">171</a>
<a href="#L172">172</a>
<a href="#L173">173</a>
<a href="#L174">174</a>
<a href="#L175">175</a>
<a href="#L176">176</a>
<a href="#L177">177</a>
<a href="#L178">178</a>
<a href="#L179">179</a>
<a href="#L180">180</a>
<a href="#L181">181</a>
<a href="#L182">182</a>
<a href="#L183">183</a>
<a href="#L184">184</a>
<a href="#L185">185</a>
<a href="#L186">186</a>
<a href="#L187">187</a>
<a href="#L188">188</a>
<a href="#L189">189</a>
<a href="#L190">190</a>
<a href="#L191">191</a>
<a href="#L192">192</a>
<a href="#L193">193</a>
<a href="#L194">194</a>
<a href="#L195">195</a>
<a href="#L196">196</a>
<a href="#L197">197</a>
<a href="#L198">198</a>
<a href="#L199">199</a>
<a href="#L200">200</a>
<a href="#L201">201</a>
<a href="#L202">202</a>
<a href="#L203">203</a>
<a href="#L204">204</a>
<a href="#L205">205</a>
<a href="#L206">206</a>
<a href="#L207">207</a>
<a href="#L208">208</a>
<a href="#L209">209</a>
<a href="#L210">210</a>
<a href="#L211">211</a>
<a href="#L212">212</a>
<a href="#L213">213</a>
<a href="#L214">214</a>
<a href="#L215">215</a>
<a href="#L216">216</a>
<a href="#L217">217</a>
<a href="#L218">218</a>
<a href="#L219">219</a>
<a href="#L220">220</a>
<a href="#L221">221</a>
<a href="#L222">222</a>
<a href="#L223">223</a>
<a href="#L224">224</a>
<a href="#L225">225</a>
<a href="#L226">226</a>
<a href="#L227">227</a>
<a href="#L228">228</a>
<a href="#L229">229</a>
<a href="#L230">230</a>
<a href="#L231">231</a>
<a href="#L232">232</a>
<a href="#L233">233</a>
<a href="#L234">234</a>
<a href="#L235">235</a>
<a href="#L236">236</a>
<a href="#L237">237</a>
<a href="#L238">238</a>
<a href="#L239">239</a>
<a href="#L240">240</a>
<a href="#L241">241</a>
<a href="#L242">242</a>
<a href="#L243">243</a>
<a href="#L244">244</a>
<a href="#L245">245</a>
<a href="#L246">246</a>
<a href="#L247">247</a>
<a href="#L248">248</a>
<a href="#L249">249</a>
<a href="#L250">250</a>
<a href="#L251">251</a>
<a href="#L252">252</a>
<a href="#L253">253</a>
<a href="#L254">254</a>
<a href="#L255">255</a>
<a href="#L256">256</a>
<a href="#L257">257</a>
<a href="#L258">258</a>
<a href="#L259">259</a>
<a href="#L260">260</a>
<a href="#L261">261</a>
<a href="#L262">262</a>
<a href="#L263">263</a>
<a href="#L264">264</a>
<a href="#L265">265</a>
<a href="#L266">266</a>
<a href="#L267">267</a>
<a href="#L268">268</a>
<a href="#L269">269</a>
<a href="#L270">270</a>
<a href="#L271">271</a>
<a href="#L272">272</a>
<a href="#L273">273</a>
<a href="#L274">274</a>
<a href="#L275">275</a>
<a href="#L276">276</a>
<a href="#L277">277</a>
<a href="#L278">278</a>
<a href="#L279">279</a>
<a href="#L280">280</a>
<a href="#L281">281</a>
<a href="#L282">282</a>
<a href="#L283">283</a>
<a href="#L284">284</a>
<a href="#L285">285</a>
<a href="#L286">286</a>
<a href="#L287">287</a>
<a href="#L288">288</a>
<a href="#L289">289</a>
<a href="#L290">290</a>
<a href="#L291">291</a>
<a href="#L292">292</a>
<a href="#L293">293</a>
<a href="#L294">294</a>
<a href="#L295">295</a>
<a href="#L296">296</a>
<a href="#L297">297</a>
<a href="#L298">298</a>
<a href="#L299">299</a>
<a href="#L300">300</a>
<a href="#L301">301</a>
<a href="#L302">302</a>
<a href="#L303">303</a>
<a href="#L304">304</a>
<a href="#L305">305</a>
<a href="#L306">306</a>
<a href="#L307">307</a>
<a href="#L308">308</a>
<a href="#L309">309</a>
<a href="#L310">310</a>
<a href="#L311">311</a>
<a href="#L312">312</a>
<a href="#L313">313</a>
<a href="#L314">314</a>
<a href="#L315">315</a>
<a href="#L316">316</a>
<a href="#L317">317</a>
<a href="#L318">318</a>
<a href="#L319">319</a>
<a href="#L320">320</a>
<a href="#L321">321</a>
<a href="#L322">322</a>
<a href="#L323">323</a>
<a href="#L324">324</a>
<a href="#L325">325</a>
<a href="#L326">326</a>
<a href="#L327">327</a>
<a href="#L328">328</a>
<a href="#L329">329</a>
<a href="#L330">330</a>
<a href="#L331">331</a>
<a href="#L332">332</a>
<a href="#L333">333</a>
<a href="#L334">334</a>
<a href="#L335">335</a>
<a href="#L336">336</a>
<a href="#L337">337</a>
<a href="#L338">338</a>
<a href="#L339">339</a>
<a href="#L340">340</a>
<a href="#L341">341</a>
<a href="#L342">342</a>
<a href="#L343">343</a>
<a href="#L344">344</a>
<a href="#L345">345</a>
<a href="#L346">346</a>
<a href="#L347">347</a>
<a href="#L348">348</a>
<a href="#L349">349</a>
<a href="#L350">350</a>
<a href="#L351">351</a>
<a href="#L352">352</a>
<a href="#L353">353</a>
<a href="#L354">354</a>
<a href="#L355">355</a>
<a href="#L356">356</a>
<a href="#L357">357</a>
<a href="#L358">358</a>
<a href="#L359">359</a>
<a href="#L360">360</a>
<a href="#L361">361</a>
<a href="#L362">362</a>
<a href="#L363">363</a>
<a href="#L364">364</a>
<a href="#L365">365</a>
<a href="#L366">366</a>
<a href="#L367">367</a>
<a href="#L368">368</a>
<a href="#L369">369</a>
<a href="#L370">370</a>
<a href="#L371">371</a>
<a href="#L372">372</a>
<a href="#L373">373</a>
<a href="#L374">374</a>
<a href="#L375">375</a>
<a href="#L376">376</a>
<a href="#L377">377</a>
<a href="#L378">378</a>
<a href="#L379">379</a>
<a href="#L380">380</a>
<a href="#L381">381</a>
<a href="#L382">382</a>
<a href="#L383">383</a>
<a href="#L384">384</a>
<a href="#L385">385</a>
<a href="#L386">386</a>
<a href="#L387">387</a>
<a href="#L388">388</a>
<a href="#L389">389</a>
<a href="#L390">390</a>
<a href="#L391">391</a>
<a href="#L392">392</a>
<a href="#L393">393</a>
<a href="#L394">394</a>
<a href="#L395">395</a>
<a href="#L396">396</a>
<a href="#L397">397</a>
<a href="#L398">398</a>
<a href="#L399">399</a>
<a href="#L400">400</a>
<a href="#L401">401</a>
<a href="#L402">402</a>
<a href="#L403">403</a>
<a href="#L404">404</a>
<a href="#L405">405</a>
<a href="#L406">406</a>
<a href="#L407">407</a>
<a href="#L408">408</a>
<a href="#L409">409</a>
<a href="#L410">410</a>
<a href="#L411">411</a>
<a href="#L412">412</a>
<a href="#L413">413</a>
<a href="#L414">414</a>
<a href="#L415">415</a>
<a href="#L416">416</a>
<a href="#L417">417</a>
<a href="#L418">418</a>
<a href="#L419">419</a>
<a href="#L420">420</a>
<a href="#L421">421</a>
</pre>
<pre><code class="ocaml">open Mo_types
open Mo_values

open Operator


(* Notes *)

type typ_note = {note_typ : Type.typ; note_eff : Type.eff}

let empty_typ_note = {note_typ = Type.Pre; note_eff = Type.Triv}

(* Resolved imports (filled in separately after parsing) *)

type lib_path = {package : string option; path : string}
type resolved_import =
  | Unresolved
  | LibPath of lib_path
  | IDLPath of (string * string) (* filepath * bytes *)
  | ImportedValuePath of string
  | PrimPath (* the built-in prim module *)

(* Identifiers *)

type id = string Source.phrase
(* type id_ref, see below *)
type typ_id = (string, Type.con option) Source.annotated_phrase


(* Types *)

type 'note sort = (Type.obj_sort, 'note) Source.annotated_phrase
type typ_obj_sort = unit sort
type persistence = bool Source.phrase
type obj_sort = persistence sort
type func_sort = Type.func_sort Source.phrase

type mut = mut' Source.phrase
and mut' = Const | Var

and typ_path = (path', Type.con option) Source.annotated_phrase
and path = (path', Type.typ) Source.annotated_phrase
and path' =
  | IdH  of id
  | DotH of path * id

and async_sort = Type.async_sort
and await_sort = Type.await_sort

type typ = (typ', Type.typ) Source.annotated_phrase
and typ' =
  | PathT of typ_path * typ list                   (* type path *)
  | PrimT of string                                (* primitive *)
  | ObjT of typ_obj_sort * typ_field list          (* object *)
  | ArrayT of mut * typ                            (* array *)
  | OptT of typ                                    (* option *)
  | VariantT of typ_tag list                       (* variant *)
  | TupT of typ_item list                          (* tuple *)
  | FuncT of func_sort * typ_bind list * typ * typ (* function *)
  | AsyncT of async_sort * scope * typ             (* future / computation *)
  | AndT of typ * typ                              (* intersection *)
  | OrT of typ * typ                               (* union *)
  | ParT of typ                                    (* parentheses, used to control function arity only *)
  | NamedT of id * typ                             (* parenthesized single element named "tuple" *)
  | WeakT of typ                                   (* weak reference *)

and scope = typ
and typ_field = typ_field' Source.phrase
and typ_field' =
  | ValF of id * typ * mut
  | TypF of typ_id * typ_bind list * typ

and typ_tag = typ_tag' Source.phrase
and typ_tag' = {tag : id; typ : typ}

and bind_sort = Type.bind_sort Source.phrase
and typ_bind = (typ_bind', Type.con option) Source.annotated_phrase
and typ_bind' = {var : id; sort : bind_sort; bound : typ;}

and typ_item = id option * typ


(* Literals *)

type lit =
  | NullLit
  | BoolLit of bool
  | NatLit of Numerics.Nat.t
  | Nat8Lit of Numerics.Nat8.t
  | Nat16Lit of Numerics.Nat16.t
  | Nat32Lit of Numerics.Nat32.t
  | Nat64Lit of Numerics.Nat64.t
  | IntLit of Numerics.Int.t
  | Int8Lit of Numerics.Int_8.t
  | Int16Lit of Numerics.Int_16.t
  | Int32Lit of Numerics.Int_32.t
  | Int64Lit of Numerics.Int_64.t
  | FloatLit of Numerics.Float.t
  | CharLit of Value.unicode
  | TextLit of string
  | BlobLit of string
  | PreLit of string * Type.prim


(* Patterns *)

type pat = (pat', Type.typ) Source.annotated_phrase
and pat' =
  | WildP                                      (* wildcard *)
  | VarP of id                                 (* variable *)
  | LitP of lit ref                            (* literal *)
  | SignP of unop * lit ref                    (* signed literal *)
  | TupP of pat list                           (* tuple *)
  | ObjP of pat_field list                     (* object *)
  | OptP of pat                                (* option *)
  | TagP of id * pat                           (* tagged variant *)
  | AltP of pat * pat                          (* disjunctive *)
  | AnnotP of pat * typ                        (* type annotation *)
  | ParP of pat                                (* parenthesis *)
(*
  | AsP of pat * pat                           (* conjunctive *)
*)

and pat_field = pat_field' Source.phrase
and pat_field' =
  | ValPF of id * pat
  | TypPF of typ_id

let pf_id pf = <span data-count="0">m</span>atch pf.Source.it with
  | <span data-count="0">V</span>alPF(id, _) -&gt; id
  | <span data-count="0">T</span>ypPF(id) -&gt; Source.{ it = id.it; at = id.at; note = () }

let pf_pattern pf = <span data-count="0">m</span>atch pf.Source.it with
  | <span data-count="0">V</span>alPF(_, pat) -&gt; Some pat
  | <span data-count="0">T</span>ypPF(_) -&gt; None

(* Expressions *)

type vis = vis' Source.phrase
and vis' =
  | Public of string option
  | Private
  | System

let is_public vis = <span data-count="4369">m</span>atch vis.Source.it with <span data-count="1980">P</span>ublic _ -&gt; true | <span data-count="2389">_</span> -&gt; false
let is_private vis = <span data-count="297936">m</span>atch vis.Source.it with <span data-count="48113">P</span>rivate -&gt; true | <span data-count="249823">_</span> -&gt; false

type stab = stab' Source.phrase
and stab' = Stable | Flexible

type op_typ = Type.typ ref (* For overloaded resolution; initially Type.Pre. *)

type inst = ((bool * typ list) option, Type.typ list) Source.annotated_phrase (* For implicit scope instantiation *)

type sort_pat = (Type.shared_sort * pat) Type.shared Source.phrase

type sugar = bool (* Is the source of a function body a block `&lt;block&gt;`,
                     subject to further desugaring during parse,
                     or the invariant form `= &lt;exp&gt;`.
                     In the final output of the parser, the exp in FuncE is
                     always in its fully desugared form and the
                     value of the sugar field is irrelevant.
                     This flag is used to correctly desugar an actor's
                     public functions as oneway, shared functions *)

type loop_flags = { mutable has_break : bool; mutable has_continue : bool }

let new_loop_flags () : loop_flags = <span data-count="22446">{</span> has_break = false; has_continue = false }

type control = Break | Continue

let auto_s = "&lt;&gt;auto"
let auto_continue_s = "continue &lt;&gt;auto"

let break_label kind (id_opt : id option) =
  <span data-count="1176">m</span>atch kind, id_opt with
  | <span data-count="18">B</span>reak, None -&gt; auto_s
  | <span data-count="13">C</span>ontinue, None -&gt; auto_continue_s
  | <span data-count="1145">_</span>, Some {Source.it; _} -&gt; it


type id_ref = (string, mut' * exp option) Source.annotated_phrase
and hole_sort = Named of string | Anon of int
and exp = (exp', typ_note) Source.annotated_phrase
and exp' =
  | HoleE of hole_sort * exp ref
  | PrimE of string                            (* primitive *)
  | VarE of id_ref                             (* variable *)
  | LitE of lit ref                            (* literal *)
  | ActorUrlE of exp                           (* actor reference *)
  | UnE of op_typ * unop * exp                 (* unary operator *)
  | BinE of op_typ * exp * binop * exp         (* binary operator *)
  | RelE of op_typ * exp * relop * exp         (* relational operator *)
  | ShowE of (op_typ * exp)                    (* debug show operator *)
  | ToCandidE of exp list                      (* to_candid operator *)
  | FromCandidE of exp                         (* from_candid operator *)
  | TupE of exp list                           (* tuple *)
  | ProjE of exp * int                         (* tuple projection *)
  | OptE of exp                                (* option injection *)
  | DoOptE of exp                              (* option monad *)
  | BangE of exp                               (* scoped option projection *)
  | ObjBlockE of exp option * obj_sort * (id option * typ option) * dec_field list  (* object block *)
  | ObjE of exp list * exp_field list          (* record literal/extension *)
  | TagE of id * exp                           (* variant *)
  | DotE of exp * id * contextual_dot_note     (* object projection *)
  | AssignE of exp * exp                       (* assignment *)
  | ArrayE of mut * exp list                   (* array *)
  | IdxE of exp * exp                          (* array indexing *)
  | FuncE of string * sort_pat * typ_bind list * pat * typ option * sugar * exp  (* function *)
  | CallE of exp option * exp * inst * arg_exp     (* function call *)
  | BlockE of dec list                         (* block (with type after avoidance) *)
  | NotE of exp                                (* negation *)
  | AndE of exp * exp                          (* conjunction *)
  | OrE of exp * exp                           (* disjunction *)
  | IfE of exp * exp * exp                     (* conditional *)
  | SwitchE of exp * case list                 (* switch *)
  | WhileE of exp * exp * loop_flags       (* while-do loop *)
  | LoopE of exp * exp option * loop_flags (* do-while loop *)
  | ForE of pat * exp * exp * loop_flags   (* iteration *)
  | LabelE of id * typ * exp                   (* label *)
  | BreakE of control * id option * exp        (* break *)
  | RetE of exp                                (* return *)
  | DebugE of exp                              (* debugging *)
  | AsyncE of exp option * async_sort * typ_bind * exp (* future / computation *)
  | AwaitE of await_sort * exp                 (* await *)
  | AssertE of assert_kind * exp               (* assertion *)
  | AnnotE of exp * typ                        (* type annotation *)
  | ImportE of (string * resolved_import ref)  (* import statement *)
  | ImplicitLibE of string                     (* implicitly imported library *)
  | ThrowE of exp                              (* throw exception *)
  | TryE of exp * case list * exp option       (* catch exception / finally *)
  | IgnoreE of exp                             (* ignore *)
(*
  | AtomE of string                            (* atom *)
 *)
and arg_exp = (bool * (exp ref))

and assert_kind =
  | Runtime

and dec_field = dec_field' Source.phrase
and dec_field' = {dec : dec; vis : vis; stab: stab option}

and exp_field = exp_field' Source.phrase
and exp_field' = {mut : mut; id : id; exp : exp}

and case = case' Source.phrase
and case' = {pat : pat; exp : exp}

(* When `Some`, this holds the expression that produces the function to apply to the receiver.
   eg. when `x.f(args...)` desugars to `M.f(x, args...)` the note will hold `M.f` *)
and contextual_dot_note = exp option ref

(* Declarations *)

and dec = (dec', typ_note) Source.annotated_phrase
and dec' =
  | ExpD of exp                                (* plain unit expression *)
  | LetD of pat * exp * exp option             (* immutable, with an optional fail block *)
  | VarD of id * exp                           (* mutable *)
  | TypD of typ_id * typ_bind list * typ       (* type *)
  | ClassD of                                  (* class *)
      exp option * sort_pat * obj_sort * typ_id * typ_bind list * pat * typ option * id * dec_field list
  | MixinD of pat * dec_field list             (* mixin *)
  | IncludeD of id * exp * include_note (* mixin include *)
and include_note' = { imports : import list; pat : pat; decs : dec_field list }
and include_note = include_note' option ref

and import = (import', Type.typ) Source.annotated_phrase
and import' = pat * string * resolved_import ref

(* Program (pre unit detection) *)

type prog_note = { filename : string; trivia : Trivia.triv_table }
type prog = (prog', prog_note) Source.annotated_phrase
and prog' = dec list

(* Signatures (stable variables) *)

type stab_sig = (stab_sig', prog_note) Source.annotated_phrase
and stab_sig' = (dec list * stab_body)      (* type declarations &amp; stable actor fields *)
and stab_body = stab_body' Source.phrase    (* type declarations &amp; stable actor fields *)
and stab_body' =
  | Single of typ_field list
  | PrePost of (req * typ_field) list * typ_field list
and req = bool Source.phrase

(* Compilation units *)

type comp_unit_body = (comp_unit_body', typ_note) Source.annotated_phrase
and comp_unit_body' =
 | ProgU of dec list                         (* main programs *)
 | ActorU of persistence * exp option * id option * dec_field list      (* main IC actor *)
 | ModuleU of id option * dec_field list     (* module library *)
 | ActorClassU of                            (* IC actor class, main or library *)
     persistence * exp option * sort_pat * typ_id * typ_bind list * pat * typ option * id * dec_field list
 | MixinU of pat * dec_field list            (* Mixins *)

type comp_unit = (comp_unit', prog_note) Source.annotated_phrase
and comp_unit' = {
  imports : import list;
  body : comp_unit_body;
  }

type lib = comp_unit


(* Helpers *)

let (@@) = Source.(@@)
let (@~) it at = <span data-count="1441944">S</span>ource.annotate (Const, None) it at
let (@?) it at = <span data-count="6353349">S</span>ource.annotate empty_typ_note it at
let (@!) it at = <span data-count="5107412">S</span>ource.annotate Type.Pre it at
let (@=) it at = <span data-count="1905122">S</span>ource.annotate None it at

(* NB: This function is currently unused *)
let string_of_lit = function
  | <span data-count="0">B</span>oolLit false -&gt; "false"
  | <span data-count="0">B</span>oolLit true  -&gt; "true"
  | <span data-count="0">I</span>ntLit n
  | <span data-count="0">N</span>atLit n      -&gt; Numerics.Int.to_pretty_string n
  | <span data-count="0">I</span>nt8Lit n     -&gt; Numerics.Int_8.to_pretty_string n
  | <span data-count="0">I</span>nt16Lit n    -&gt; Numerics.Int_16.to_pretty_string n
  | <span data-count="0">I</span>nt32Lit n    -&gt; Numerics.Int_32.to_pretty_string n
  | <span data-count="0">I</span>nt64Lit n    -&gt; Numerics.Int_64.to_pretty_string n
  | <span data-count="0">N</span>at8Lit n     -&gt; Numerics.Nat8.to_pretty_string n
  | <span data-count="0">N</span>at16Lit n    -&gt; Numerics.Nat16.to_pretty_string n
  | <span data-count="0">N</span>at32Lit n    -&gt; Numerics.Nat32.to_pretty_string n
  | <span data-count="0">N</span>at64Lit n    -&gt; Numerics.Nat64.to_pretty_string n
  | <span data-count="0">C</span>harLit c     -&gt; string_of_int c
  | <span data-count="0">N</span>ullLit       -&gt; "null"
  | <span data-count="0">T</span>extLit t     -&gt; t
  | <span data-count="0">B</span>lobLit b     -&gt; b
  | <span data-count="0">F</span>loatLit f    -&gt; Numerics.Float.to_pretty_string f
  | PreLit _      -&gt; assert false

(** Used for debugging *)
let string_of_resolved_import = function
  | <span data-count="0">L</span>ibPath {path; package } -&gt; Printf.sprintf "LibPath {path = %s, package = %s}" path (match package with | <span data-count="0">S</span>ome p -&gt; p | <span data-count="0">N</span>one -&gt; "None")
  | <span data-count="0">I</span>DLPath (path, _) -&gt; Printf.sprintf "IDLPath (%s, _)" path
  | <span data-count="0">I</span>mportedValuePath path -&gt; Printf.sprintf "ImportedValuePath %s" path
  | <span data-count="0">P</span>rimPath -&gt; "PrimPath"
  | <span data-count="0">U</span>nresolved -&gt; "Unresolved"

(* Miscellaneous *)
(* TODO: none of what follows should probably be in this file *)

open Source


(* Identifiers *)

let anon_id sort at = <span data-count="66666">"</span>@anon-" ^ sort ^ "-" ^ string_of_po<span data-count="66666">s</span> at.left
let is_anon_id id = <span data-count="100">L</span>ib.String.chop_prefi<span data-count="100">x</span> "@anon-" id.it &lt;&gt; None

let is_privileged name =
  <span data-count="915420">S</span>tring.lengt<span data-count="915420">h</span> name &gt; 0 &amp;&amp; <span data-count="915420">n</span>ame.[0] = '@'

let is_underscored name =
  <span data-count="914006">S</span>tring.lengt<span data-count="914006">h</span> name &gt; 0 &amp;&amp; <span data-count="914006">n</span>ame.[0] = '_'

let is_scope name =
  <span data-count="24">S</span>tring.lengt<span data-count="24">h</span> name &gt; 0 &amp;&amp; <span data-count="24">n</span>ame.[0] = '$'

(* Types &amp; Scopes *)

let arity t =
  <span data-count="0">m</span>atch t.Source.it with
  | <span data-count="0">T</span>upT ts -&gt; List.length ts
  | <span data-count="0">_</span> -&gt; 1

let is_any t =
  <span data-count="0">m</span>atch t.it with
  | <span data-count="0">P</span>rimT "Any" -&gt; true
  | <span data-count="0">_</span> -&gt; false

let scopeT at =
  <span data-count="25639">P</span>athT (IdH {it = Type.default_scope_var; at; note = ()} @<span data-count="25639">=</span> at, []) @! at


(* Expressions *)

let asyncE sort tbs e =
  <span data-count="5572">A</span>syncE (None, sort, tbs, e) @? e.at

let ignore_asyncE tbs e =
  <span data-count="226">I</span>gnoreE (
    AnnotE (AsyncE (None, Type.Fut, tbs, e) @<span data-count="226">?</span> e.at,
      AsyncT (Type.Fut, scope<span data-count="226">T</span> e.at, TupT [] @<span data-count="226">!</span> e.at) @<span data-count="226">!</span> e.at) @<span data-count="226">?</span> e.at ) @? e.at

let is_asyncE e =
  <span data-count="40243">m</span>atch e.it with
  | <span data-count="16984">A</span>syncE _ -&gt; true
  | <span data-count="23259">_</span> -&gt; false

let is_ignore_asyncE e =
  <span data-count="226">m</span>atch e.it with
  | <span data-count="222">I</span>gnoreE
      {it = AnnotE ({it = AsyncE (None, Type.Fut, _, _); _},
        {it = AsyncT (Type.Fut, _, {it = TupT []; _}); _}); _} -&gt;
    true
  | <span data-count="4">_</span> -&gt; false

let contextual_dot_args e1 e2 dot_note =
  <span data-count="28">l</span>et module T = Mo_types.Type in
  let arity = match dot_note.note.note_typ with
    | <span data-count="28">T</span>.Func(_, _, _, args, _) -&gt; List.lengt<span data-count="28">h</span> args
    | <span data-count="0">_</span> -&gt; raise (Invalid_argument "non-function type in contextual dot note") in
  let effect eff =
    <span data-count="28">m</span>atch (e1.note.note_eff, eff) with
    | <span data-count="27">T</span>.Triv, T.Triv -&gt; T.Triv
    | <span data-count="1">_</span>, _ -&gt; T.Await
  in
  let args = match e2 with
    | <span data-count="7">{</span> it = TupE []; at; note = { note_eff;_ } } -&gt;
       { it = e1.it; at; note = { note_eff = effec<span data-count="7">t</span> note_eff; note_typ = e1.note.note_typ } }
    | <span data-count="12">{</span> it = TupE exps; at; note = { note_eff; note_typ = T.Tup ts } } when arity &lt;&gt; 2 -&gt;
       <span data-count="11">{</span> it = TupE (e1::exps); at; note = { note_eff = effec<span data-count="11">t</span> note_eff; note_typ = T.Tup (e1.note.note_typ::ts) } }
    | <span data-count="10">{</span> at; note = { note_eff; _ }; _ } -&gt;
       { it = TupE ([e1; e2]); at; note = { note_eff = effec<span data-count="10">t</span> note_eff; note_typ = T.Tup ([e1.note.note_typ; e2.note.note_typ]) } }
  in args
</code></pre>
      </div>
    </div>
    <script src="../coverage.js"></script>
  </body>
</html>
